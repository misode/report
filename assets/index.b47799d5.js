var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,r=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,l=(e,t)=>{for(var a in t||(t={}))i.call(t,a)&&r(e,a,t[a]);if(s)for(var a of s(t))n.call(t,a)&&r(e,a,t[a]);return e},o=(e,s)=>t(e,a(s));import{a as c,l as p,y as m,J as u,N as d}from"./vendor.87791f12.js";function v({title:e,items:t,name:a}){return c("div",{class:`card area-${a}`},e&&c("div",{class:"card-title"},e,c("span",null,"(",t.length,")")),c("div",{class:"collection-list"},t.map((e=>c("span",{class:"card-value"},e)))))}function g({data:e,goal:t,title:a,name:s}){const i=(e.reduce(((e,t)=>e+t))/e.length).toFixed(3);return c("div",{class:`card graph area-${s}`,style:"--goal: "+1.5*t},e.map((e=>{const a=`hsl(${Math.max(0,150-100*e/t)}deg, 80%, 55%)`;return c("div",{class:"graph-value",style:`--value: ${Math.round(e)}; --color: ${a};`})})),a&&c("span",{class:"graph-title"},a),c("span",{class:"graph-info"},"avg: ",i))}function f({title:e,properties:t,name:a,defaults:s={}}){return c("div",{class:`card area-${a}`},e&&c("div",{class:"card-title"},e),c("div",{class:"card-properties"},t.filter((e=>"string"==typeof e[1])).map((e=>c("div",{class:"card-property"+(void 0!==s[e[0]]&&s[e[0]]!==e[1]?" altered":"")},c("span",{class:"card-key"},e[0],": "),c("span",{class:"card-value"},e[1]))))))}function k({name:e,columns:t,data:a}){const[s,i]=p(Math.min(100,a.length));return c("div",{class:`card table area-${e}`},c("div",{class:"table-row table-head"},t.map((e=>c("div",{class:"table-column"},e)))),c("div",{class:"table-body"},a.slice(0,s).map((e=>c("div",{class:"table-row"},e.map((e=>c("div",{class:"table-column"},e)))))),a.length>s&&c("div",{class:"table-row table-foot"},c("div",null,a.length-s," entries hidden"),a.length-s>100&&c("div",{class:"table-action",onClick:()=>i(s+100)},"Show 100 more"),c("div",{class:"table-action",onClick:()=>i(a.length)},"Show all")),0===a.length&&c("div",{class:"table-row table-foot"},c("div",null,"None"))))}function y({report:e}){return c(m,null,c(f,{name:"gamerules",properties:Object.entries(e.server.gamerules),defaults:h}))}const h={announceAdvancements:"true",commandBlockOutput:"true",disableElytraMovementCheck:"false",disableRaids:"false",doDaylightCycle:"true",doEntityDrops:"true",doFireTick:"true",doInsomnia:"true",doImmediateRespawn:"false",doLimitedCrafting:"false",doMobLoot:"true",doMobSpawning:"true",doPatrolSpawning:"true",doTileDrops:"true",doTraderSpawning:"true",doWeatherCycle:"true",drowningDamage:"true",fallDamage:"true",fireDamage:"true",forgiveDeadPlayers:"true",freezeDamage:"true",keepInventory:"false",logAdminCommands:"true",maxCommandChainLength:"65536",maxEntityCramming:"24",mobGriefing:"true",naturalRegeneration:"true",playersSleepingPercentage:"100",randomTickSpeed:"3",reducedDebugInfo:"false",sendCommandFeedback:"true",showDeathMessages:"true",spawnRadius:"10",spectatorsGenerateChunks:"true",universalAnger:"false"};function b({report:e}){const[t,a]=p("entities");return c(m,null,c("ul",{class:"panels"},c("li",{class:"panel"+("entities"===t?" active":""),onClick:()=>a("entities")},"Entities"),c("li",{class:"panel"+("block-entities"===t?" active":""),onClick:()=>a("block-entities")},"Block entities"),c("li",{class:"panel"+("chunks"===t?" active":""),onClick:()=>a("chunks")},"Chunks"),c("li",{class:"panel"+("stats"===t?" active":""),onClick:()=>a("stats")},"Stats")),"entities"===t&&c(k,{name:"entities",columns:["Type","Position","Dimension"],data:Object.entries(e.server.levels).flatMap((([e,t])=>t.entities.map((t=>o(l({},t),{dimension:e}))))).map((e=>[e.type.replace(/^minecraft:/,""),`${Math.round(e.x)} ${Math.round(e.y)} ${Math.round(e.z)}`,e.dimension.replace(/^minecraft:/,"")]))}),"block-entities"===t&&c(k,{name:"block-entities",columns:["Type","Position","Dimension"],data:Object.entries(e.server.levels).flatMap((([e,t])=>t.blockEntities.map((t=>o(l({},t),{dimension:e}))))).map((e=>[e.type.replace(/^minecraft:/,""),`${Math.round(e.x)} ${Math.round(e.y)} ${Math.round(e.z)}`,e.dimension.replace(/^minecraft:/,"")]))}),"chunks"===t&&c(k,{name:"chunks",columns:["Position","Dimension","Level","Status","Entities"],data:Object.entries(e.server.levels).flatMap((([e,t])=>t.chunks.map((t=>o(l({},t),{dimension:e}))))).map((t=>{var a,s,i,n;return[`${Math.round(t.x)} ${Math.round(t.z)}`,t.dimension.replace(/^minecraft:/,""),`${t.level}`,"minecraft:full"===t.status?null!=(s=null==(a=t.fullStatus)?void 0:a.toLowerCase())?s:"unknown":null!=(n=null==(i=t.status)?void 0:i.replace(/^minecraft:/,""))?n:"unknown",`${e.server.levels[t.dimension].entityChunks.filter((e=>e.x===t.x&&e.z===t.z)).reduce(((e,t)=>e+t.entityCount),0)}`]}))}),"stats"===t&&Object.entries(e.server.levels).map((([e,{stats:t}])=>c(f,{name:"level-stats",title:e,properties:[["Entities",`${t.entities.knownUuids}`],["Block entities",`${t.blockEntityTickers}`],["Block ticks",`${t.blockTicks}`],["Fluid ticks",`${t.fluidTicks}`],["Spawning chunks",`${t.spawningChunks}`]]}))))}function w({report:e}){const t=e.server.stats.averageTickTime,a=Math.min(...e.server.stats.tickTimes)/1e6,s=Math.max(...e.server.stats.tickTimes)/1e6;return c(m,null,c(f,{name:"stats",title:e.client?"Server stats":"Stats",properties:[["Average tick",`${t.toFixed(3)} mspt`],["Minimum tick",`${a.toFixed(3)} mspt`],["Maximum tick",`${s.toFixed(3)} mspt`]]}),c(g,{name:"tick-graph",title:e.client?"Server tick (mspt)":"Tick (mspt)",goal:50,data:e.server.stats.tickTimes.map((e=>e/1e6))}),c(g,{name:"server-metrics",title:e.client?"Full server tick":"Full tick",goal:50,data:e.server.metrics.ticking.map((e=>e.tickTime/1e6))}),e.client&&c(g,{name:"client-metrics",title:"Client tick",goal:60,data:e.client.metrics.ticking.map((e=>1e3/(e.tickTime/1e6)))}),e.server.metrics.jvm&&c(g,{name:"server-jvm",title:"JVM heap (MiB)",goal:2e3,data:e.server.metrics.jvm.map((e=>e.heap))}))}function $({report:e}){var t;const[a,s]=p("server"),[i,n]=p(new Set),r=(null!=(t=e[a])?t:e.server).profiling,l=1e3*r.tickSpan/r.timeSpan;return c(m,null,e.client&&c("ul",{class:"panels"},c("li",{class:"panel"+("server"===a?" active":""),onClick:()=>s("server")},"Server"),c("li",{class:"panel"+("client"===a?" active":""),onClick:()=>s("client")},"Client")),c(f,{name:"profiling-stats",properties:[["Time span",`${r.timeSpan} ms`],["Tick span",`${r.tickSpan} ticks`],["Average tick",`${l.toFixed(3)} mspt`]]}),c("div",{class:"card profile area-profile-dump"},c(C,{children:r.dump,hidden:i,path:"root",level:0,tickTime:l,onToggle:e=>{i.has(e)?i.delete(e):i.add(e),n(new Set(i))}})))}function C({children:e,hidden:t,path:a,level:s,tickTime:i,onToggle:n}){return c(m,null,Object.entries(e).map((([e,r])=>{const l=`${a}.${e}`;return c(m,null,c("div",{class:`profile-entry level-${s}`,onClick:r.children&&(()=>n(l))},c("div",{class:"profile-name"},e.startsWith("ServerLevel[")?e.split(" ").pop():e),void 0!==r.ofTotal&&c("div",{class:"profile-parts"},c("span",null,r.ofParent," % / "),r.ofTotal," %"),void 0!==r.ofTotal&&c("div",{class:"profile-times"},(i*r.ofTotal/100).toFixed(3)," ms"),c("div",{class:"profile-counts"},c("span",null,r.count," / "),r.averageCount)),r.children&&!t.has(l)&&c(C,{children:r.children,hidden:t,path:l,level:s+1,tickTime:i,onToggle:n}))})))}function T({report:e}){return c(m,null,c(f,{name:"version",title:"Minecraft version",properties:[["Name",e.system.versionName],["Id",e.system.versionId],["Is modded",e.system.isModded]]}),e.client&&c(f,{name:"game-options",title:"Game options",properties:[["Player count",`${e.system.playerCount.join(" / ")}`],["Language",e.system.language],["Graphics mode",e.system.graphicsMode],["Using VBOs",e.system.vbos?"Yes":"No"]]}),c(f,{name:"software",title:"Software",properties:[["Operating system",e.system.operatingSystem],["Java version",e.system.javaVersion],["Java VM version",e.system.jvmVersion],["Library",e.system.library]]}),c(f,{name:"hardware",title:"Hardware",properties:[["Processor",e.system.processorName],["CPUs",`${e.system.cpus}`],["Frequency",`${e.system.frequency} GHz`],["Graphics card",e.system.graphicsCardName]]}),c(v,{name:"data-packs",title:"Data packs",items:e.system.dataPacks}),e.system.resourcePacks&&c(v,{name:"resource-packs",title:"Resource packs",items:e.system.resourcePacks}))}const M={x:c("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},c("path",{"fill-rule":"evenodd",d:"M3.72 3.72a.75.75 0 011.06 0L8 6.94l3.22-3.22a.75.75 0 111.06 1.06L9.06 8l3.22 3.22a.75.75 0 11-1.06 1.06L8 9.06l-3.22 3.22a.75.75 0 01-1.06-1.06L6.94 8 3.72 4.78a.75.75 0 010-1.06z"}))};var x;!function(e){async function t(e,t){var a,s;const n=await i(e,t),r=n.indexOf("--- BEGIN PROFILE DUMP ---")+2,o=n.indexOf("--- END PROFILE DUMP ---"),c=[],p=[];let m=-1;for(let i=r;i<o;i+=1){const e=n[i].match(/^\[(\d\d)\][ |]+(.*)(\((\d+)\/(\d+)\) - ([\d\.]+)%\/([\d\.]+)%| (\d+)\/(\d+))$/),t=parseInt(e[1]),r=e[2];t>m?c.push({}):p.pop();for(let a=0;a<m-t;a+=1){const e=c.pop();c[c.length-1][p.pop()].children=e}p.push(r),m=t,c[c.length-1][r]=l({count:parseInt(null!=(a=e[4])?a:e[8]),averageCount:parseInt(null!=(s=e[5])?s:e[9])},e[6]&&{ofParent:parseFloat(e[6]),ofTotal:parseFloat(e[7])})}return{timeSpan:parseInt(n[4].split(":")[1]),tickSpan:parseInt(n[5].split(":")[1]),dump:c[0]}}async function a(e,t){const[a,...s]=await i(e,t),n=a.split(",").map((e=>e.trim()));return s.map((e=>Object.fromEntries(e.split(",").map(((e,t)=>[n[t],e.trim()])))))}async function s(e,t,a=":"){const s=await i(e,t);return Object.fromEntries(s.filter((e=>e.includes(a))).map((e=>{const[t,...s]=e.split(a);return[t,s.join(a).trim()]})))}async function i(e,t){const a=e.files[t];if(!a)throw new Error(`Cannot find "${t}"`);return(await a.async("text")).trimEnd().split("\n")}(x||(x={})).fromZip=async function(e){var i;const n=await e.arrayBuffer(),r=await u.loadAsync(n),c=await s(r,"system.txt");return o(l(l({name:e.name},await async function(e){if(!e.files["client/"])return{};const i=await a(e,"client/metrics/ticking.csv"),n=await s(e,"client/options.txt"),r=await t(e,"client/profiling.txt");return{client:{metrics:{ticking:i.map((e=>({tick:parseInt(e["@tick"]),tickTime:Number(e.ticktime)})))},options:n,profiling:r}}}(r)),await async function(e){const i=e.files["server/metrics/jvm.csv"]?await a(e,"server/metrics/jvm.csv"):void 0,n=await a(e,"server/metrics/ticking.csv"),r=await t(e,"server/profiling.txt"),l=await s(e,"server/gamerules.txt","="),o=await s(e,"server/stats.txt"),c=Object.keys(e.files).filter((e=>e.match(/^server\/levels\/[a-z0-9_-]+\/[a-z0-9_-]+\/$/))),p=await Promise.all(c.map((t=>async function(e,t){const i=await a(e,`${t}block_entities.csv`),n=await a(e,`${t}chunks.csv`),r=await a(e,`${t}entities.csv`),l=await a(e,`${t}entity_chunks.csv`),o=await s(e,`${t}stats.txt`),c=o.entities.split(",").map((e=>parseInt(e)));return{blockEntities:i.map((e=>({x:parseFloat(e.x),y:parseFloat(e.y),z:parseFloat(e.z),type:e.type}))),chunks:n.map((e=>({x:parseInt(e.x),z:parseInt(e.z),level:parseInt(e.level),inMemory:"true"===e.in_memory,status:"[null]"===e.status?null:e.status,fullStatus:"[null]"===e.full_status?null:e.full_status,accessibleReady:e.accessible_ready,tickingReady:e.ticking_ready,entityTickingReady:e.entity_ticking_ready,spawning:"true"===e.spawning,blockEntityCount:parseInt(e.block_entity_count)}))),entities:r.map((e=>({x:parseFloat(e.x),y:parseFloat(e.y),z:parseFloat(e.z),uuid:e.uuid,type:e.type,alive:"true"===e.alive,displayName:e.display_name,customName:"[null]"===e.custom_name?null:e.custom_name}))),entityChunks:l.map((e=>({x:parseFloat(e.x),y:parseFloat(e.y),z:parseFloat(e.z),visibility:e.visibility,loadStatus:e.load_status,entityCount:parseInt(e.entity_count)}))),stats:{spawningChunks:parseInt(o.spawning_chunks),entities:{knownUuids:c[0],visibleEntityStorage:c[1],sectionStorage:c[2],chunkLoadStatuses:c[3],chunkVisibility:c[4],loadingInbox:c[5],chunksToUnload:c[6]},blockEntityTickers:parseInt(o.block_entity_tickers),blockTicks:parseInt(o.block_ticks),fluidTicks:parseInt(o.fluid_ticks),pendingTasks:parseInt(o.pending_tasks)}}}(e,t))));return{server:{levels:Object.fromEntries(c.map(((e,t)=>[e.replace(/^server\/levels\/([a-z0-9_-]+)\/([a-z0-9_-]+)\/$/,"$1:$2"),p[t]]))),metrics:{jvm:null==i?void 0:i.map((e=>({tick:parseInt(e["@tick"]),heap:parseInt(e["heap MiB"])}))),ticking:n.map((e=>({tick:parseInt(e["@tick"]),tickTime:Number(e.ticktime)})))},gamerules:l,profiling:r,stats:{pendingTasks:parseInt(o.pending_tasks),averageTickTime:parseFloat(o.average_tick_time),tickTimes:JSON.parse(o.tick_times)}}}}(r)),{system:{versionName:c["Minecraft Version"],versionId:c["Minecraft Version ID"],isModded:c["Is Modded"].startsWith("Probably not.")?"No":c["Is Modded"].startsWith("Unknown")?"Unknown":"Yes",resourcePacks:null==(i=c["Resource Packs"])?void 0:i.split(",").map((e=>e.trim())),dataPacks:c["Data Packs"].split(",").map((e=>e.trim())),operatingSystem:c["Operating System"],javaVersion:c["Java Version"],jvmVersion:c["Java VM Version"],library:c["Backend library"],processorName:c["Processor Name"],cpus:parseInt(c.CPUs),frequency:parseFloat(c["Frequency (GHz)"]),graphicsCardName:c["Graphics card #0 name"],playerCount:c["Player Count"].split(";")[0].split(" / ").map((e=>parseInt(e))),language:c["Current Language"],graphicsMode:c["Graphics mode"],vbos:c["Using VBOs"]?"Yes"===c["Using VBOs"]:void 0}})}}();const I=["Overview","System","Gamerules","Levels","Profiling"];function S(){const[e,t]=p([]),[a,s]=p(0),[i,n]=p("Overview"),[r,l]=p([]),o=e[Math.min(e.length-1,a)];return c("main",{onDrop:async a=>{if(a.preventDefault(),!a.dataTransfer)return;const i=[];let n="";for(let t=0;t<a.dataTransfer.files.length;t++){const s=a.dataTransfer.files[t];s.type.match(/^application\/(x-)?zip(-compressed)?$/)&&(e.find((e=>e.name===s.name))?n=s.name:i.push(x.fromZip(s)))}if(i.length>0){const a=await Promise.all(i.map((async e=>{try{return await e}catch(t){return l([...r,t.message]),void console.error(t)}})));s(e.length+a.length-1),t([...e,...a.filter((e=>void 0!==e))])}else{const t=e.findIndex((e=>e.name===n));-1!==t&&s(t)}},onDragOver:e=>e.preventDefault()},0===e.length?c(m,null,c("div",{class:"drop"},c("h1",null,"Drop profiling report here"),c("p",null,"Singleplayer: F3 + L"),c("p",null,"Multiplayer: /perf start"),c("p",null,"Located in .minecraft/debug/profiling/"))):c(m,null,c("ul",{class:"tabs"},e.map(((i,n)=>c("li",{class:"tab"+(Math.min(e.length-1,a)===n?" active":""),onClick:()=>s(n),title:i.name},c("div",{class:"tab-name"},i.name.replace(/\.zip$/,"")),c("button",{class:"tab-remove",onClick:()=>{return a=n,void t(e.filter(((e,t)=>t!==a)));var a}},M.x))))),c("ul",{class:"panels"},I.map((e=>c("li",{class:"panel"+(i===e?" active":""),onClick:()=>n(e)},e)))),c("div",{class:"report "+(o.client?"client-report":"server-report")},"Overview"===i&&c(w,{report:o}),"System"===i&&c(T,{report:o}),"Gamerules"===i&&c(y,{report:o}),"Levels"===i&&c(b,{report:o}),"Profiling"===i&&c($,{report:o})),c("div",{class:"footer"},c("p",null,"Developed by Misode"),c("p",null,"Source code on ",c("a",{href:"https://github.com/misode/report",target:"_blank"},"GitHub")))),r.map((e=>c("div",{class:"error"},c("p",null,"Something went wrong loading the report:"),c("p",{class:"error-message"},e),c("p",null,"What you can do:",c("ul",null,c("li",null,"Ensure that you are not using a version below 1.17-pre1"),c("li",null,"Report this as a bug ",c("a",{href:"https://github.com/misode/report/issues/new",target:"_blank"},"on GitHub")," and upload the report"))),c("div",{class:"error-close",onClick:()=>l(r.filter((t=>t!==e)))},"x")))))}d(c(S,null),document.body);
