var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,r=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,l=(e,t)=>{for(var a in t||(t={}))i.call(t,a)&&r(e,a,t[a]);if(s)for(var a of s(t))n.call(t,a)&&r(e,a,t[a]);return e},o=(e,s)=>t(e,a(s));import{a as c,l as p,y as u,J as m,N as d}from"./vendor.87791f12.js";function v({title:e,items:t,name:a}){return c("div",{class:`card area-${a}`},e&&c("div",{class:"card-title"},e,c("span",null,"(",t.length,")")),c("div",{class:"collection-list"},t.map((e=>c("span",{class:"card-value"},e)))))}function f({data:e,goal:t,title:a,name:s}){const i=(e.reduce(((e,t)=>e+t))/e.length).toFixed(3);return c("div",{class:`card graph area-${s}`,style:"--goal: "+1.5*t},e.map((e=>{const a=`hsl(${Math.max(0,150-100*e/t)}deg, 80%, 55%)`;return c("div",{class:"graph-value",style:`--value: ${Math.round(e)}; --color: ${a};`})})),a&&c("span",{class:"graph-title"},a),c("span",{class:"graph-info"},"avg: ",i))}function g({title:e,properties:t,name:a,defaults:s={}}){return c("div",{class:`card area-${a}`},e&&c("div",{class:"card-title"},e),c("div",{class:"card-properties"},t.filter((e=>"string"==typeof e[1])).map((e=>c("div",{class:"card-property"+(void 0!==s[e[0]]&&s[e[0]]!==e[1]?" altered":"")},c("span",{class:"card-key"},e[0],": "),c("span",{class:"card-value"},e[1]))))))}function k({name:e,columns:t,data:a}){const[s,i]=p(Math.min(100,a.length));return c("div",{class:`card table area-${e}`},c("div",{class:"table-row table-head"},t.map((e=>c("div",{class:"table-column"},e)))),c("div",{class:"table-body"},a.slice(0,s).map((e=>c("div",{class:"table-row"},e.map((e=>c("div",{class:"table-column"},e)))))),a.length>s&&c("div",{class:"table-row table-foot"},c("div",null,a.length-s," entries hidden"),a.length-s>100&&c("div",{class:"table-action",onClick:()=>i(s+100)},"Show 100 more"),c("div",{class:"table-action",onClick:()=>i(a.length)},"Show all")),0===a.length&&c("div",{class:"table-row table-foot"},c("div",null,"None"))))}function h({report:e}){var t,a;const[s,i]=p("entities");return c(u,null,c("ul",{class:"panels"},c("li",{class:"panel"+("entities"===s?" active":""),onClick:()=>i("entities")},"Entities"),c("li",{class:"panel"+("block-entities"===s?" active":""),onClick:()=>i("block-entities")},"Block entities"),c("li",{class:"panel"+("chunks"===s?" active":""),onClick:()=>i("chunks")},"Chunks"),c("li",{class:"panel"+("stats"===s?" active":""),onClick:()=>i("stats")},"Stats")),"entities"===s&&c(k,{name:"entities",columns:["Type","Position","Dimension"],data:Object.entries(null!=(r=null==(n=e.server)?void 0:n.levels)?r:{}).flatMap((([e,t])=>t.entities.map((t=>o(l({},t),{dimension:e}))))).map((e=>[e.type.replace(/^minecraft:/,""),`${Math.round(e.x)} ${Math.round(e.y)} ${Math.round(e.z)}`,e.dimension.replace(/^minecraft:/,"")]))}),"block-entities"===s&&c(k,{name:"block-entities",columns:["Type","Position","Dimension"],data:(()=>{var t,a;return Object.entries(null!=(a=null==(t=e.server)?void 0:t.levels)?a:{}).flatMap((([e,t])=>t.blockEntities.map((t=>o(l({},t),{dimension:e}))))).map((e=>[e.type.replace(/^minecraft:/,""),`${Math.round(e.x)} ${Math.round(e.y)} ${Math.round(e.z)}`,e.dimension.replace(/^minecraft:/,"")]))})()}),"chunks"===s&&c(k,{name:"chunks",columns:["Position","Dimension","Level","Status","Entities"],data:(()=>{var t,a;return Object.entries(null!=(a=null==(t=e.server)?void 0:t.levels)?a:{}).flatMap((([e,t])=>t.chunks.map((t=>o(l({},t),{dimension:e}))))).map((t=>{var a,s,i,n;return[`${Math.round(t.x)} ${Math.round(t.z)}`,t.dimension.replace(/^minecraft:/,""),`${t.level}`,"minecraft:full"===t.status?null!=(s=null==(a=t.fullStatus)?void 0:a.toLowerCase())?s:"unknown":null!=(n=null==(i=t.status)?void 0:i.replace(/^minecraft:/,""))?n:"unknown",`${e.server.levels[t.dimension].entityChunks.filter((e=>e.x===t.x&&e.z===t.z)).reduce(((e,t)=>e+t.entityCount),0)}`]}))})()}),"stats"===s&&Object.entries(null!=(a=null==(t=e.server)?void 0:t.levels)?a:{}).map((([e,{stats:t}])=>c(g,{name:"level-stats",title:e,properties:[["Entities",`${t.entities.knownUuids}`],["Block entities",`${t.blockEntityTickers}`],["Block ticks",`${t.blockTicks}`],["Fluid ticks",`${t.fluidTicks}`],["Spawning chunks",`${t.spawningChunks}`]]}))));var n,r}function y({report:e}){var t,a;return c(u,null,(null==(t=e.server)?void 0:t.gamerules)&&c(g,{title:"Gamerules",name:"gamerules",properties:Object.entries(e.server.gamerules),defaults:b}),(null==(a=e.client)?void 0:a.options)&&c(g,{title:"Client Options",name:"options",properties:Object.entries(e.client.options),defaults:w}))}const b={announceAdvancements:"true",commandBlockOutput:"true",disableElytraMovementCheck:"false",disableRaids:"false",doDaylightCycle:"true",doEntityDrops:"true",doFireTick:"true",doInsomnia:"true",doImmediateRespawn:"false",doLimitedCrafting:"false",doMobLoot:"true",doMobSpawning:"true",doPatrolSpawning:"true",doTileDrops:"true",doTraderSpawning:"true",doWeatherCycle:"true",drowningDamage:"true",fallDamage:"true",fireDamage:"true",forgiveDeadPlayers:"true",freezeDamage:"true",keepInventory:"false",logAdminCommands:"true",maxCommandChainLength:"65536",maxEntityCramming:"24",mobGriefing:"true",naturalRegeneration:"true",playersSleepingPercentage:"100",randomTickSpeed:"3",reducedDebugInfo:"false",sendCommandFeedback:"true",showDeathMessages:"true",spawnRadius:"10",spectatorsGenerateChunks:"true",universalAnger:"false"},w={ao:"MAX",biomeBlendRadius:"2",enableVsync:"true",entityDistanceScaling:"1.0",entityShadows:"true",forceUnicodeFont:"false",fov:"70.0",fovEffectScale:"1.0",fullscreen:"false",gamma:"1.0",glDebugVerbosity:"1",graphicsMode:"fancy",guiScale:"0",maxFps:"120",mipmapLevels:"4",narrator:"OFF",overrideHeight:"0",overrideWidth:"0",particles:"ALL",reducedDebugInfo:"false",renderClouds:"FANCY",renderDistance:"12",screenEffectScale:"1.0",useNativeTransport:"true"};function C({report:e}){var t,a,s,i,n,r,l,o;console.log(e);const p=null!=(a=null==(t=e.server)?void 0:t.stats.averageTickTime)?a:0,m=Math.min(...null!=(i=null==(s=e.server)?void 0:s.stats.tickTimes)?i:[])/1e6,d=Math.max(...null!=(r=null==(n=e.server)?void 0:n.stats.tickTimes)?r:[])/1e6;return c(u,null,e.server&&c(g,{name:"stats",title:e.client?"Server stats":"Stats",properties:[["Average tick",`${p.toFixed(3)} mspt`],["Minimum tick",`${m.toFixed(3)} mspt`],["Maximum tick",`${d.toFixed(3)} mspt`]]}),e.server&&c(f,{name:"tick-graph",title:e.client?"Server tick (mspt)":"Tick (mspt)",goal:50,data:e.server.stats.tickTimes.map((e=>e/1e6))}),e.server&&c(f,{name:"server-metrics",title:e.client?"Full server tick (ms)":"Full tick",goal:50,data:e.server.metrics.ticking.map((e=>e.tickTime/1e6))}),e.client&&c(f,{name:"client-metrics",title:"Client tick (ms)",goal:60,data:e.client.metrics.ticking.map((e=>1e3/(e.tickTime/1e6)))}),(null==(l=e.server)?void 0:l.metrics.jvm)&&c(f,{name:"server-jvm",title:"Server JVM heap (MiB)",goal:2e3,data:e.server.metrics.jvm.map((e=>e.heap))}),(null==(o=e.client)?void 0:o.metrics.jvm)&&c(f,{name:"client-jvm",title:"Client JVM heap (MiB)",goal:2e3,data:e.client.metrics.jvm.map((e=>e.heap))}))}const T={rows:c("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},c("path",{"fill-rule":"evenodd",d:"M16 2.75A1.75 1.75 0 0014.25 1H1.75A1.75 1.75 0 000 2.75v2.5A1.75 1.75 0 001.75 7h12.5A1.75 1.75 0 0016 5.25v-2.5zm-1.75-.25a.25.25 0 01.25.25v2.5a.25.25 0 01-.25.25H1.75a.25.25 0 01-.25-.25v-2.5a.25.25 0 01.25-.25h12.5zM16 10.75A1.75 1.75 0 0014.25 9H1.75A1.75 1.75 0 000 10.75v2.5A1.75 1.75 0 001.75 15h12.5A1.75 1.75 0 0016 13.25v-2.5zm-1.75-.25a.25.25 0 01.25.25v2.5a.25.25 0 01-.25.25H1.75a.25.25 0 01-.25-.25v-2.5a.25.25 0 01.25-.25h12.5z"})),x:c("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},c("path",{"fill-rule":"evenodd",d:"M3.72 3.72a.75.75 0 011.06 0L8 6.94l3.22-3.22a.75.75 0 111.06 1.06L9.06 8l3.22 3.22a.75.75 0 11-1.06 1.06L8 9.06l-3.22 3.22a.75.75 0 01-1.06-1.06L6.94 8 3.72 4.78a.75.75 0 010-1.06z"}))};function M({report:e}){var t,a;const[s,i]=p(e.server?"server":"client"),[n,r]=p("tree"),[l,o]=p(new Set),m=(null!=(a=null!=(t=e[s])?t:e.server)?a:e.client).profiling,d=m.timeSpan/m.tickSpan;return c(u,null,e.client&&e.server&&c("ul",{class:"panels"},c("li",{class:"panel"+("server"===s?" active":""),onClick:()=>i("server")},"Server"),c("li",{class:"panel"+("client"===s?" active":""),onClick:()=>i("client")},"Client")),c(g,{name:"profiling-stats",properties:[["Time span",`${m.timeSpan} ms`],["Tick span",`${m.tickSpan} ticks`],["Average tick",`${d.toFixed(3)} mspt`]]}),c("div",{class:"card table area-profiling"},c("div",{class:"table-row table-head"},c("div",{class:"table-column profile-name"},c("div",{class:"table-button table-prefix",onClick:()=>r("list"===n?"tree":"list")},T.rows),"Name"),c("div",{class:"table-column table-button profile-parent-part"},"% Parent"),c("div",{class:"table-column table-button profile-total-part"},"% Total"),c("div",{class:"table-column table-button profile-time"},"Avg Time"),c("div",{class:"table-column table-button profile-total-count"},"Count"),c("div",{class:"table-column table-button profile-average-count"},"Avg Count")),c("div",{class:"table-body"},"tree"===n?c(x,{children:m.dump,hidden:l,path:"root",level:0,tickTime:d,onToggle:e=>{l.has(e)?l.delete(e):l.add(e),o(new Set(l))}}):c(S,{children:m.dump,tickTime:d}))))}function x({children:e,hidden:t,path:a,level:s,tickTime:i,onToggle:n}){return c(u,null,Object.entries(e).map((([e,t])=>[e,`${a}.${e}`,t])).map((([e,a,r])=>c(u,null,c($,{name:e,props:r,tickTime:i,level:s,onClick:()=>n(a)}),r.children&&!t.has(a)&&c(x,{children:r.children,hidden:t,path:a,level:s+1,tickTime:i,onToggle:n})))))}function S({children:e,tickTime:t}){return c(u,null,Object.entries(e).map((([e,a])=>c(u,null,c($,{name:e,props:a,tickTime:t}),a.children&&c(S,{children:a.children,tickTime:t})))))}function $({name:e,props:t,tickTime:a,level:s,onClick:i}){return c("div",{class:"table-row "+(s?`level-${s}`:""),onClick:i},c("div",{class:"profile-name"},e.startsWith("ServerLevel[")?e.split(" ").pop():e),void 0!==t.ofTotal&&c(u,null,c("div",{class:"profile-parent-part"},t.ofParent," %"),c("div",{class:"profile-total-part"},t.ofTotal," %"),c("div",{class:"profile-time"},(a*t.ofTotal/100).toFixed(3)," ms")),c("div",{class:"profile-total-count"},t.count),c("div",{class:"profile-average-count"},t.averageCount))}function I({report:e}){var t;return c(u,null,c(g,{name:"version",title:"Minecraft version",properties:[["Name",e.system.versionName],["Id",e.system.versionId],["Is modded",e.system.isModded]]}),e.client&&c(g,{name:"game-options",title:"Game options",properties:[["Player count",null==(t=e.system.playerCount)?void 0:t.join(" / ")],["Language",e.system.language],["Graphics mode",e.system.graphicsMode],["Using VBOs",e.system.vbos?"Yes":"No"]]}),c(g,{name:"software",title:"Software",properties:[["Operating system",e.system.operatingSystem],["Java version",e.system.javaVersion],["Java VM version",e.system.jvmVersion],["Library",e.system.library]]}),c(g,{name:"hardware",title:"Hardware",properties:[["Processor",e.system.processorName],["CPUs",e.system.cpus.toFixed()],["Frequency",`${e.system.frequency} GHz`],["Graphics card",e.system.graphicsCardName]]}),e.system.dataPacks&&c(v,{name:"data-packs",title:"Data packs",items:e.system.dataPacks}),e.system.resourcePacks&&c(v,{name:"resource-packs",title:"Resource packs",items:e.system.resourcePacks}))}var O;!function(e){async function t(e,t){var a,s;const n=await i(e,t),r=n.indexOf("--- BEGIN PROFILE DUMP ---")+2,o=n.indexOf("--- END PROFILE DUMP ---"),c=[],p=[];let u=-1;for(let i=r;i<o;i+=1){const e=n[i].match(/^\[(\d\d)\][ |]+(.*)(\((\d+)\/(\d+)\) - ([\d\.]+)%\/([\d\.]+)%| (\d+)\/(\d+))$/),t=parseInt(e[1]),r=e[2];t>u?c.push({}):p.pop();for(let a=0;a<u-t;a+=1){const e=c.pop();c[c.length-1][p.pop()].children=e}p.push(r),u=t,c[c.length-1][r]=l({count:parseInt(null!=(a=e[4])?a:e[8]),averageCount:parseInt(null!=(s=e[5])?s:e[9])},e[6]&&{ofParent:parseFloat(e[6]),ofTotal:parseFloat(e[7])})}return{timeSpan:parseInt(n[4].split(":")[1]),tickSpan:parseInt(n[5].split(":")[1]),dump:c[0]}}async function a(e,t){const[a,...s]=await i(e,t),n=a.split(",").map((e=>e.trim()));return s.map((e=>Object.fromEntries(e.split(",").map(((e,t)=>[n[t],e.trim()])))))}async function s(e,t,a=":"){const s=await i(e,t);return Object.fromEntries(s.filter((e=>e.includes(a))).map((e=>{const[t,...s]=e.split(a);return[t,s.join(a).trim()]})))}async function i(e,t){const a=e.files[t];if(!a)throw new Error(`Cannot find "${t}"`);return(await a.async("text")).trimEnd().split("\n")}(O||(O={})).fromZip=async function(e){var i,n,r;const c=await e.arrayBuffer(),p=await m.loadAsync(c),u=await s(p,"system.txt");return o(l(l({name:e.name},await async function(e){if(!e.files["client/options.txt"])return;const i=e.files["client/metrics/jvm.csv"]?await a(e,"client/metrics/jvm.csv"):void 0,n=await a(e,"client/metrics/ticking.csv"),r=await s(e,"client/options.txt"),l=await t(e,"client/profiling.txt");return{client:{metrics:{jvm:null==i?void 0:i.map((e=>({tick:parseInt(e["@tick"]),heap:parseInt(e["heap MiB"])}))),ticking:n.map((e=>({tick:parseInt(e["@tick"]),tickTime:Number(e.ticktime)})))},options:r,profiling:l}}}(p)),await async function(e){if(!e.files["server/stats.txt"])return;const i=e.files["server/metrics/jvm.csv"]?await a(e,"server/metrics/jvm.csv"):void 0,n=await a(e,"server/metrics/ticking.csv"),r=await t(e,"server/profiling.txt"),l=await s(e,"server/gamerules.txt","="),o=await s(e,"server/stats.txt"),c=Object.keys(e.files).map((e=>{var t,a;return null!=(a=null==(t=e.match(/^server\/levels\/([a-z0-9_-]+(?:\/[a-z0-9_-]+)+)\/stats.txt$/))?void 0:t[1])?a:void 0})).filter((e=>void 0!==e)),p=await Promise.all(c.map((t=>async function(e,t){const i=await a(e,`server/levels/${t}/block_entities.csv`),n=await a(e,`server/levels/${t}/chunks.csv`),r=await a(e,`server/levels/${t}/entities.csv`),l=await a(e,`server/levels/${t}/entity_chunks.csv`),o=await s(e,`server/levels/${t}/stats.txt`),c=o.entities.split(",").map((e=>parseInt(e)));return{blockEntities:i.map((e=>({x:parseFloat(e.x),y:parseFloat(e.y),z:parseFloat(e.z),type:e.type}))),chunks:n.map((e=>({x:parseInt(e.x),z:parseInt(e.z),level:parseInt(e.level),inMemory:"true"===e.in_memory,status:"[null]"===e.status?null:e.status,fullStatus:"[null]"===e.full_status?null:e.full_status,accessibleReady:e.accessible_ready,tickingReady:e.ticking_ready,entityTickingReady:e.entity_ticking_ready,spawning:"true"===e.spawning,blockEntityCount:parseInt(e.block_entity_count)}))),entities:r.map((e=>({x:parseFloat(e.x),y:parseFloat(e.y),z:parseFloat(e.z),uuid:e.uuid,type:e.type,alive:"true"===e.alive,displayName:e.display_name,customName:"[null]"===e.custom_name?null:e.custom_name}))),entityChunks:l.map((e=>({x:parseFloat(e.x),y:parseFloat(e.y),z:parseFloat(e.z),visibility:e.visibility,loadStatus:e.load_status,entityCount:parseInt(e.entity_count)}))),stats:{spawningChunks:parseInt(o.spawning_chunks),entities:{knownUuids:c[0],visibleEntityStorage:c[1],sectionStorage:c[2],chunkLoadStatuses:c[3],chunkVisibility:c[4],loadingInbox:c[5],chunksToUnload:c[6]},blockEntityTickers:parseInt(o.block_entity_tickers),blockTicks:parseInt(o.block_ticks),fluidTicks:parseInt(o.fluid_ticks),pendingTasks:parseInt(o.pending_tasks)}}}(e,t))));return{server:{levels:Object.fromEntries(c.map(((e,t)=>[e.replace("/",":"),p[t]]))),metrics:{jvm:null==i?void 0:i.map((e=>({tick:parseInt(e["@tick"]),heap:parseInt(e["heap MiB"])}))),ticking:n.map((e=>({tick:parseInt(e["@tick"]),tickTime:Number(e.ticktime)})))},gamerules:l,profiling:r,stats:{pendingTasks:parseInt(o.pending_tasks),averageTickTime:parseFloat(o.average_tick_time),tickTimes:JSON.parse(o.tick_times)}}}}(p)),{system:{versionName:u["Minecraft Version"],versionId:u["Minecraft Version ID"],isModded:u["Is Modded"].startsWith("Probably not.")?"No":u["Is Modded"].startsWith("Unknown")?"Unknown":"Yes",resourcePacks:null==(i=u["Resource Packs"])?void 0:i.split(",").map((e=>e.trim())),dataPacks:null==(n=u["Data Packs"])?void 0:n.split(",").map((e=>e.trim())),operatingSystem:u["Operating System"],javaVersion:u["Java Version"],jvmVersion:u["Java VM Version"],library:u["Backend library"],processorName:u["Processor Name"],cpus:parseInt(u.CPUs),frequency:parseFloat(u["Frequency (GHz)"]),graphicsCardName:u["Graphics card #0 name"],playerCount:null==(r=u["Player Count"])?void 0:r.split(";")[0].split(" / ").map((e=>parseInt(e))),language:u["Current Language"],graphicsMode:u["Graphics mode"],vbos:u["Using VBOs"]?"Yes"===u["Using VBOs"]:void 0}})}}();const j=["Overview","System","Options","Levels","Profiling"];function P(){const[e,t]=p([]),[a,s]=p(0),[i,n]=p("Overview"),[r,l]=p([]),o=e[Math.min(e.length-1,a)];return c("main",{onDrop:async a=>{if(a.preventDefault(),!a.dataTransfer)return;r&&l([]);const i=[];let n="";for(let t=0;t<a.dataTransfer.files.length;t++){const s=a.dataTransfer.files[t];s.type.match(/^application\/(x-)?zip(-compressed)?$/)&&(e.find((e=>e.name===s.name))?n=s.name:i.push(O.fromZip(s)))}if(i.length>0){const a=await Promise.all(i.map((async e=>{try{return await e}catch(t){return l([...r,t.message]),void console.error(t)}})));s(e.length+a.length-1),t([...e,...a.filter((e=>void 0!==e))])}else{const t=e.findIndex((e=>e.name===n));-1!==t&&s(t)}},onDragOver:e=>e.preventDefault()},0===e.length?c(u,null,c("div",{class:"drop"},c("h1",null,"Drop profiling report here"),c("p",null,"Singleplayer: F3 + L"),c("p",null,"Multiplayer: /perf start"),c("p",null,"Located in .minecraft/debug/profiling/"))):c(u,null,c("ul",{class:"tabs"},e.map(((i,n)=>c("li",{class:"tab"+(Math.min(e.length-1,a)===n?" active":""),onClick:()=>s(n),title:i.name},c("div",{class:"tab-name"},i.name.replace(/\.zip$/,"")),c("button",{class:"tab-remove",onClick:()=>{return a=n,void t(e.filter(((e,t)=>t!==a)));var a}},T.x))))),c("ul",{class:"panels"},j.filter((e=>!(void 0===o.server&&"Levels"===e))).map((e=>c("li",{class:"panel"+(i===e?" active":""),onClick:()=>n(e)},e)))),c("div",{class:`report${o.client?" client-report":""}${o.server?" server-report":""}`},"Overview"===i&&c(C,{report:o}),"System"===i&&c(I,{report:o}),"Options"===i&&c(y,{report:o}),"Levels"===i&&c(h,{report:o}),"Profiling"===i&&c(M,{report:o})),c("div",{class:"footer"},c("p",null,"Developed by Misode"),c("p",null,"Source code on ",c("a",{href:"https://github.com/misode/report",target:"_blank"},"GitHub")))),r.map((e=>c("div",{class:"error"},c("p",null,"Something went wrong loading the report:"),c("p",{class:"error-message"},e),c("p",null,"What you can do:",c("ul",null,c("li",null,"Ensure that you are not using a version below 1.17-pre1"),c("li",null,"Report this as a bug ",c("a",{href:"https://github.com/misode/report/issues/new",target:"_blank"},"on GitHub")," and upload the report"))),c("div",{class:"error-close",onClick:()=>l(r.filter((t=>t!==e)))},"x")))))}d(c(P,null),document.body);
