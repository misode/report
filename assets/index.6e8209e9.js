import{a as e,y as t,J as a,l as s,N as i}from"./vendor.87791f12.js";function r(a){return e(t,null)}function n({title:t,properties:a,name:s}){return e("div",{class:`card area-${s}`},t&&e("div",{class:"card-title"},t),e("div",{class:"card-table"},a.map((t=>e("div",{class:"card-property"},e("span",{class:"card-key"},t[0],": "),e("span",{class:"card-value"},t[1]))))))}function c({data:t,goal:a,title:s,name:i}){const r=(t.reduce(((e,t)=>e+t))/t.length).toFixed(3);return e("div",{class:`card graph area-${i}`,style:"--goal: "+1.5*a},t.map((t=>{const s=`hsl(${Math.max(0,150-100*t/a)}deg, 80%, 55%)`;return e("div",{class:"graph-value",style:`--value: ${t}; --color: ${s};`})})),s&&e("span",{class:"graph-title"},s),e("span",{class:"graph-info"},"avg: ",r))}function l({title:t,items:a,name:s}){return e("div",{class:`card area-${s}`},t&&e("div",{class:"card-title"},t),e("div",{class:"collection-list"},a.map((t=>e("span",{class:"card-value"},t)))))}const o={x:e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},e("path",{"fill-rule":"evenodd",d:"M3.72 3.72a.75.75 0 011.06 0L8 6.94l3.22-3.22a.75.75 0 111.06 1.06L9.06 8l3.22 3.22a.75.75 0 11-1.06 1.06L8 9.06l-3.22 3.22a.75.75 0 01-1.06-1.06L6.94 8 3.72 4.78a.75.75 0 010-1.06z"}))};var m;!function(e){async function t(e,t){const[a,...s]=await i(e,t),r=a.split(",").map((e=>e.trim()));return s.map((e=>Object.fromEntries(e.split(",").map(((e,t)=>[r[t],e.trim()])))))}async function s(e,t,a=":"){const s=await i(e,t);return Object.fromEntries(s.filter((e=>e.includes(a))).map((e=>{const[t,...s]=e.split(a);return[t,s.join(a).trim()]})))}async function i(e,t){const a=e.files[t];if(!a)throw new Error(`Cannot find "${t}"`);return(await a.async("text")).trimEnd().split("\n")}(m||(m={})).fromZip=async function(e){const i=await e.arrayBuffer(),r=await a.loadAsync(i),n=await t(r,"client/metrics/ticking.csv"),c=await s(r,"client/options.txt"),l=await t(r,"server/metrics/ticking.csv"),o=await s(r,"server/gamerules.txt","="),m=await s(r,"server/stats.txt"),p=await s(r,"system.txt"),u=Object.keys(r.files).filter((e=>e.match(/^server\/levels\/[a-z0-9_-]+\/[a-z0-9_-]+\/$/))),d=await Promise.all(u.map((e=>async function(e,a){const i=await t(e,`${a}block_entities.csv`),r=await t(e,`${a}chunks.csv`),n=await t(e,`${a}entities.csv`),c=await t(e,`${a}entity_chunks.csv`),l=await s(e,`${a}stats.txt`),o=l.entities.split(",").map((e=>parseInt(e)));return{blockEntities:i.map((e=>({x:parseFloat(e.x),y:parseFloat(e.y),z:parseFloat(e.z),type:e.type}))),chunks:r.map((e=>({x:parseInt(e.x),z:parseInt(e.z),level:parseInt(e.level),inMemory:"true"===e.in_memory,status:e.status,fullStatus:e.full_status,accessibleReady:e.accessible_ready,tickingReady:e.ticking_ready,entityTickingReady:e.entity_ticking_ready,spawning:"true"===e.spawning,blockEntityCount:parseInt(e.block_entity_count)}))),entities:n.map((e=>({x:parseFloat(e.x),y:parseFloat(e.y),z:parseFloat(e.z),uuid:e.uuid,type:e.type,alive:"true"===e.alive,displayName:e.display_name,customName:"[null]"===e.custom_name?null:e.custom_name}))),entityChunks:c.map((e=>({x:parseFloat(e.x),y:parseFloat(e.y),z:parseFloat(e.z),visibility:e.visibility,loadStatus:e.load_status,entityCount:parseInt(e.entity_count)}))),stats:{spawningChunks:parseInt(l.spawning_chunks),entities:{knownUuids:o[0],visibleEntityStorage:o[1],sectionStorage:o[2],chunkLoadStatuses:o[3],chunkVisibility:o[4],loadingInbox:o[5],chunksToUnload:o[6]},blockEntityTickers:parseInt(l.block_entity_tickers),blockTicks:parseInt(l.block_ticks),fluidTicks:parseInt(l.fluid_ticks),pendingTasks:parseInt(l.pending_tasks)}}}(r,e))));return{name:e.name.replace(/\.zip$/,""),client:{metrics:{ticking:n.map((e=>({tick:parseInt(e["@tick"]),tickTime:Number(e.ticktime)})))},options:c},server:{levels:Object.fromEntries(u.map(((e,t)=>[e.replace(/^server\/levels\/([a-z0-9_-]+)\/([a-z0-9_-]+)\/$/,"$1:$2"),d[t]]))),metrics:{ticking:l.map((e=>({tick:parseInt(e["@tick"]),tickTime:Number(e.ticktime)})))},gamerules:o,stats:{pendingTasks:parseInt(m.pending_tasks),averageTickTime:parseFloat(m.average_tick_time),tickTimes:JSON.parse(m.tick_times)}},system:{versionName:p["Minecraft Version"],versionId:p["Minecraft Version ID"],isModded:!p["Is Modded"].startsWith("Probably not."),resourcePacks:p["Resource Packs"].split(",").map((e=>e.trim())),dataPacks:p["Data Packs"].split(",").map((e=>e.trim())),operatingSystem:p["Operating System"],javaVersion:p["Java Version"],jvmVersion:p["Java VM Version"],library:p["Backend library"],processorName:p["Processor Name"],cpus:parseInt(p.CPUs),frequency:parseFloat(p["Frequency (GHz)"]),graphicsCardName:p["Graphics card #0 name"],playerCount:p["Player Count"].split(";")[0].split(" / ").map((e=>parseInt(e))),language:p["Current Language"],graphicsMode:p["Graphics mode"],vbos:"Yes"===p["Using VBOs"]}}}}();const p=[["Overview",function(a){const s=a.server.stats.averageTickTime,i=Math.min(...a.server.stats.tickTimes)/1e6,r=Math.max(...a.server.stats.tickTimes)/1e6;return e(t,null,e(n,{name:"stats",title:"Server Stats",properties:[["Average tick",`${s.toFixed(3)} mspt`],["Minimum tick",`${i.toFixed(3)} mspt`],["Maximum tick",`${r.toFixed(3)} mspt`]]}),e(c,{name:"tick-graph",title:"Milliseconds per tick",goal:50,data:a.server.stats.tickTimes.map((e=>Math.round(e/1e6)))}),e(c,{name:"server-metrics",title:"Server metrics",goal:50,data:a.server.metrics.ticking.map((e=>Math.round(e.tickTime/1e6)))}),e(c,{name:"client-metrics",title:"Client metrics",goal:60,data:a.client.metrics.ticking.map((e=>Math.round(1e3/(e.tickTime/1e6))))}))}],["System",function(a){return e(t,null,e(n,{name:"version",title:"Minecraft Version",properties:[["Name",a.system.versionName],["Id",a.system.versionId],["Is Modded",a.system.isModded?"Yes":"Probably not"]]}),e(n,{name:"game-options",title:"Game Options",properties:[["Player Count",`${a.system.playerCount.join(" / ")}`],["Language",a.system.language],["Graphics Mode",a.system.graphicsMode],["Using VBOs",a.system.vbos?"Yes":"No"]]}),e(n,{name:"software",title:"Software",properties:[["Operating System",a.system.operatingSystem],["Java Version",a.system.javaVersion],["Java VM",a.system.jvmVersion],["Library",a.system.library]]}),e(n,{name:"hardware",title:"Hardware",properties:[["Processor",a.system.processorName],["CPUs",`${a.system.cpus}`],["Frequency",`${a.system.frequency} GHz`],["Graphics Card",a.system.graphicsCardName]]}),e(l,{name:"data-packs",title:"Data Packs",items:a.system.dataPacks}),e(l,{name:"resource-packs",title:"Resource Packs",items:a.system.resourcePacks}))}],["Gamerules",function(a){return e(t,null,e(n,{name:"gamerules",properties:Object.entries(a.server.gamerules)}))}],["levels",r],["Profiling",r]];function u(){const[a,i]=s([]),[r,n]=s(0),[c,l]=s(0);return e("main",{onDrop:async e=>{if(e.preventDefault(),e.dataTransfer)for(let t=0;t<e.dataTransfer.files.length;t++){const s=e.dataTransfer.files[t];if(s.type.match(/^application\/(x-)?zip(-compressed)?$/)){const e=await m.fromZip(s),t=a.findIndex((t=>t.name===e.name));t>=0?n(t):(console.log(e.name,e),n(a.length),i([...a,e]))}}},onDragOver:e=>e.preventDefault()},0===a.length?e(t,null,e("div",{class:"drop"},e("h1",null,"Drop profiling report here"),e("p",null,"Singleplayer: F3 + L"),e("p",null,"Multiplayer: /perf start"),e("p",null,"Located in .minecraft/debug/profiling/"))):e(t,null,e("ul",{class:"tabs"},a.map(((t,s)=>e("li",{class:"tab"+(r===s?" active":""),onClick:()=>n(s),title:t.name},e("div",{class:"tab-name"},t.name),e("button",{class:"tab-remove",onClick:()=>{return e=s,void i(a.filter(((t,a)=>a!==e)));var e}},o.x))))),e("ul",{class:"panels"},p.map(((t,a)=>e("li",{class:"panel"+(c===a?" active":""),onClick:()=>l(a)},t[0])))),e("div",{class:"report"},p[c][1](a[r]))))}i(e(u,null),document.body);
